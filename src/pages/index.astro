---
import SocialList from "@/components/SocialList.astro";
import PostPreview from "@/components/blog/PostPreview.astro";
import { getAllPosts, sortMDByDate } from "@/data/post";
import PageLayout from "@/layouts/Base.astro";

import ContactForm from "@/components/ContactForm.astro";

const MAX_POSTS = 10;
const allPosts = await getAllPosts();
const allPostsByDate = sortMDByDate(allPosts).slice(0, MAX_POSTS);

const cactusTech: { desc: string; href: string; title: string }[] = [
	{
		desc: "Population, Age Distribution.",
		href: "https://dataforafghanistan.org/posts/people/",
		title: "People",
	},
	{
		desc: "Poverty, Unemployment, Life Satisfaction.",
		href: "https://dataforafghanistan.org/posts/economy/",
		title: "Economy",
	},
	{
		desc: "Food Insecurity, Life Expectancy, Mortality.",
		href: "https://dataforafghanistan.org/posts/health/",
		title: "Health",
	},
  {
		desc: "Education Completion, Education Attainment, Literacy, Government Spending.",
		href: "https://dataforafghanistan.org/posts/education/",
		title: "Education",
	},
	{
		desc: "Water Use, Sanitation Use.",
		href: "https://dataforafghanistan.org/posts/water-sanitation/",
		title: "Water & Sanitation",
	},
	{
		desc: "Air Pollution, Natural Disasters.",
		href: "https://dataforafghanistan.org/posts/environment/",
		title: "Environment",
	},
	{
		desc: "Agriculture, Food Yield.",
		href: "https://dataforafghanistan.org/posts/natural-resources/",
		title: "Natural Resources",
	},
 {
		desc: "Airstrikes, Civilian Casualties.",
		href: "https://dataforafghanistan.org/posts/conflict/",
		title: "Conflict",
	},
	{
		desc: "United Nations Sustainable Development Goals.",
		href: "https://dataforafghanistan.org/posts/sdgs/",
		title: "SDGs",
	},
];
---

<PageLayout meta={{ title: "Home", description: "Access comprehensive data analysis on Afghanistan, covering economy, education, healthcare, water, environment, natural resources. Our interactive charts and graphs provide insights into Afghanistan. Explore statistics and historical data to understand Afghanistan’s progress and challenges. Your go-to source for data on Afghanistan.", }}>
	<section>
		<h1 class="title mb-6">Your Gateway to Trusted Data Visualizations & Analysis on Afghanistan</h1>
		<p class="mb-4">
			Discover, learn, and engage with key topics on Afghanistan through our curated and 
accessible data visualizations and analysis. Our platform's goal is to democratize data on Afghanistan, so that anyone can gain knowledge  
about Afghanistan, anytime and anywhere.
		</p>
	</section>

  <!-- <SocialList />    Disabled  
	<section aria-label="Blog post list" class="mt-16">
		<h2 class="title mb-4 text-xl">Data Pages</h2>
		<ul class="space-y-4">
			{
				allPostsByDate.map((p) => (
					<li class="grid gap-2 sm:grid-cols-[auto_1fr] sm:[&_q]:col-start-2">
						<PostPreview post={p} />
					</li>
				))
			}
		</ul>
	</section>  -->

     <!-- Data Categories Section -->
	<section class="mt-16">
		<h2 class="title mb-4 text-xl">Data Pages</h2>
		<p class="mb-6 text-gray-800 dark:text-gray-800">
			Choose a data category to discover interactive visualizations and insights on Afghanistan.
		</p>
		
		<div class="audience-box bg-gray-100 dark:bg-gray-800 p-6 rounded-lg">
			<dl class="space-y-4">
				{
					cactusTech.map(({ desc, href, title }) => (
						<div class="flex flex-col gap-2 sm:flex-row sm:items-center hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded transition-colors">
							<dt>
								<span class="flex items-center">
									<a class="cactus-link font-semibold dark:text-gray-300" href={href} rel="noopener noreferrer">
										{title}
									</a>
									<span class="ml-2 dark:text-gray-300">:</span>
								</span>
							</dt>
							<dd class="text-gray-700 dark:text-gray-300">{desc}</dd>
						</div>
					))
				}
			</dl>
		</div>
	</section>


    <!-- <Sample Visualization />    --> 
  <section class="mt-16">
		<h2 class="title mb-4 text-xl">Featured Visualization: Afghanistan's Rare-Earth and Industrial Minerals</h2>

  <div style="min-height:632px" id="datawrapper-vis-SobRb"><script type="text/javascript" defer src="https://datawrapper.dwcdn.net/SobRb/embed.js" charset="utf-8" data-target="#datawrapper-vis-SobRb"></script><noscript><img src="https://datawrapper.dwcdn.net/SobRb/full.png" alt="Afghanistan mineral resources, resource estimates, and deposit types." /></noscript></div>
  </section>


<!-- Why Data for Afghanistan -->
	<section class="mt-16">
		<h2 class="title mb-6 text-xl">Why Data for Afghanistan?</h2>
		
		<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
			<div class="audience-box bg-gray-100 dark:bg-gray-800 p-6 rounded-lg">
				<h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-300">Verified Sources</h3>
				<p class="text-gray-800 dark:text-gray-300">
					All data sourced from authoritative organizations like the World Bank and United Nations
				</p>
			</div>
			
			<div class="audience-box bg-gray-100 dark:bg-gray-800 p-6 rounded-lg">
				<h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-300">Interactive Visualizations</h3>
				<p class="text-gray-800 dark:text-gray-300">
					Easy-to-understand charts and graphs that make complex data accessible
				</p>
			</div>

			<div class="audience-box bg-gray-100 dark:bg-gray-800 p-6 rounded-lg">
				<h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-300">Timely Analysis</h3>
				<p class="text-gray-800 dark:text-gray-300">
					Quarterly economic reporting and periodic commentaries on Afghanistan's development
				</p>
			</div>
			
			<div class="audience-box bg-gray-100 dark:bg-gray-800 p-6 rounded-lg">
				<h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-300">Free & Accessible</h3>
				<p class="text-gray-800 dark:text-gray-300">
					Democratizing data for anyone, anywhere, under Creative Commons license
				</p>
			</div>
			
		</div>
	</section>


<!-- Newsletter Signup Section -->
<section class="mt-16">

	<div class="border-2 border-gray-300 dark:border-gray-600 rounded-lg p-8 bg-gray-50 dark:bg-gray-800">
		<div class="max-w-2xl mx-auto">
			<div class="text-center mb-6">
				<h3 class="text-2xl font-semibold text-gray-700 dark:text-gray-200 mb-2">
					Join Our Newsletter
				</h3>
				<p class="text-sm text-gray-500 dark:text-gray-400">
					Get the latest data insights delivered to your inbox
				</p>
			</div>
			
			<form action="https://api.web3forms.com/submit" method="POST" id="newsletter-form">
				<input type="hidden" name="access_key" value="ba9c0164-3664-4e28-b842-f2abfb3124c9" />
				<input type="hidden" name="subject" value="Newsletter Signup-DfA" />
				<input type="hidden" name="redirect" value="https://dataforafghanistan.org/" />
				<input type="checkbox" name="botcheck" id="" style="display: none;" />
				
				<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
					<!-- Email (Required) -->
					<div class="md:col-span-2">
						<label for="newsletter-email" class="block mb-2 text-sm font-medium text-gray-600 dark:text-gray-400">
							Email Address
						</label>
						<input
							type="email"
							name="email"
							id="newsletter-email"
							placeholder="you@example.com"
							required
							class="w-full px-3 py-2 placeholder-gray-300 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-indigo-100 focus:border-indigo-300 dark:bg-gray-700 dark:text-white dark:placeholder-gray-500 dark:border-gray-600 dark:focus:ring-gray-900 dark:focus:border-gray-500"
						/>
					</div>
					
															
					<!-- Affiliation  -->
					<div class="md:col-span-2">
						<label for="newsletter-affiliation" class="block mb-2 text-sm font-medium text-gray-600 dark:text-gray-400">
							Affiliation
						</label>
						<select
							name="affiliation"
							id="newsletter-affiliation"
							required
							class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-indigo-100 focus:border-indigo-300 dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:focus:ring-gray-900 dark:focus:border-gray-500"
						>
							<option value="">Select your affiliation</option>
							<option value="academic">Academic/Student</option>
							<option value="ngo">Humanitarian Agency</option>
							<option value="journalist">Journalist/Media</option>
							<option value="policy">Policy Maker</option>
							<option value="diaspora">Afghan Diaspora</option>
							<option value="other">Other</option>
						</select>
					</div>
				</div>
				
				<!-- Privacy Notice -->
				<p class="text-xs text-gray-500 dark:text-gray-400 mb-4">
					We respect your privacy. Your information will only be used to send you updates about Data for Afghanistan. You can unsubscribe at any time.
				</p>
				
				<!-- Submit Button -->
				<div class="mb-4">
					<button
						type="submit"
						class="w-full px-4 py-3 text-white bg-green-400 rounded-md hover:bg-green-600 focus:bg-green-600 focus:outline-none font-semibold transition-colors"
					>
						Subscribe to Our Newsletter
					</button>
				</div>
				
				<p class="text-sm text-center text-gray-400" id="newsletter-result"></p>
			</form>
		</div>
	</div>
</section>

<script>
document.addEventListener("DOMContentLoaded", function () {

    /* ---------- Reset newsletter form on page load ---------- */
    const newsletterForm = document.getElementById("newsletter-form");
    if (newsletterForm) {
        newsletterForm.reset();
    }

    /* ---------- Newsletter form handling ---------- */
    const resultElement = document.getElementById("newsletter-result");

    if (newsletterForm) {
        newsletterForm.addEventListener("submit", function (e) {
            e.preventDefault();

            const formData = new FormData(newsletterForm);
            const button = newsletterForm.querySelector('button[type="submit"]');
            const originalText = button.textContent;

            button.textContent = "Subscribing...";
            button.disabled = true;

            fetch("https://api.web3forms.com/submit", {
                method: "POST",
                body: formData
            })
            .then(async response => {
                const json = await response.json();

                if (response.ok) {
                    resultElement.textContent = "✓ Successfully subscribed!";
                    resultElement.className = "text-sm text-center text-green-500";

                    // Reset again after successful submission
                    newsletterForm.reset();
                } else {
                    resultElement.textContent = json.message || "Something went wrong. Please try again.";
                    resultElement.className = "text-sm text-center text-red-500";
                }
            })
            .catch(() => {
                resultElement.textContent = "Error: Unable to subscribe. Please try again.";
                resultElement.className = "text-sm text-center text-red-500";
            })
            .finally(() => {
                button.textContent = originalText;
                button.disabled = false;
            });
        });
    }
});
</script>


<!-- <Sample Visualization />    --> 
  <section class="mt-16">
		<h2 class="title mb-4 text-xl">Featured Visualization: Sustainable Development Progress in Afghanistan</h2>

  <iframe title="The Sustainable Development Goals Scores (0-100), 2023 vs. 2010" aria-label="Arrow Plot" id="datawrapper-chart-DtZPY" src="https://datawrapper.dwcdn.net/DtZPY/6/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="490" data-external="1"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r=0;r<e.length;r++)if(e[r].contentWindow===a.source){var i=a.data["datawrapper-height"][t]+"px";e[r].style.height=i}}}))}();
</script>
  </section>

<!-- Sponsor Section -->
	<section class="mt-16">
		<h2 class="title mb-6 text-xl">Support Our Mission</h2>
		
		<div class="audience-box bg-gray-100 dark:bg-gray-800 p-6 rounded-lg">
			<p class="text-gray-800 dark:text-gray-300 mb-4">
				Increase your brand recognition by becoming a silver or gold sponsor of Data for Afghanistan, which receives <strong>2,000+</strong> views per month across <strong>18+</strong> countries. Our website holds <strong>1st Page Google Ranking</strong> for "Afghanistan Data" keywords.
			</p>
			
			<div class="text-center">
				<a 
					href="https://dataforafghanistan.org/sponsor/" 
					class="inline-block px-8 py-3 bg-green-400 text-white font-semibold rounded-md hover:bg-green-600 transition-colors"
				>
					Become a Sponsor
				</a>
			</div>
		</div>
	</section>

<!-- Copyright License -->
	<section class="mt-16">
		<h2 class="title mb-4 text-xl">Copyright License</h2>
		
		<div class="audience-box bg-gray-100 dark:bg-gray-800 p-6 rounded-lg">
			<p class="mb-4 text-gray-800 dark:text-gray-300">
				All data visualizations (i.e., the material) of Data for Afghanistan are licensed under the Creative Commons Attribution-No Derivatives-Non Commercial 4.0 International License (CC BY-ND-NC 4.0).
			</p>
			
			<p class="mb-2 font-semibold text-gray-800 dark:text-gray-300">You are free to:</p>
			<ul class="list-disc pl-6 mb-4 space-y-1 text-gray-700 dark:text-gray-300">
				<li><strong>Share</strong> — copy and redistribute the material in any medium or format for non-commercial purposes.</li>
			</ul>
			
			<p class="mb-2 font-semibold text-gray-800 dark:text-gray-300">Under the following terms:</p>
			<ul class="list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300">
				<li><strong>Attribution</strong> — When sharing the material, you must give appropriate credit to Data for Afghanistan by providing license information along with references. We provide a reference and license format under each visualization.</li>
				<li><strong>No Derivatives</strong> — The material should be shared as it is, without any modifications.</li>
				<li><strong>Non-Commercial</strong> — You may not use the material for commercial purposes.</li>
			</ul>
		</div>
	</section>



</PageLayout>
